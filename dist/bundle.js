function r(r,e,n,t){return new(n||(n=Promise))((function(o,s){function i(r){try{h(t.next(r))}catch(r){s(r)}}function u(r){try{h(t.throw(r))}catch(r){s(r)}}function h(r){var e;r.done?o(r.value):(e=r.value,e instanceof n?e:new n((function(r){r(e)}))).then(i,u)}h((t=t.apply(r,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class e{constructor(r){this.body=r}then(r,e){return this.body.then(r,e)}unwrap(){return this.body.then((r=>r.unwrap()))}unwrap_or(r){return this.body.then((e=>e.unwrap_or(r)))}unwrap_or_else(r){return this.body.then((e=>e.unwrap_or(r())))}is_some(){return this.body.then((r=>r.is_some()))}is_some_and(r){return this.body.then((e=>e.is_some_and(r)))}is_none(){return this.body.then((r=>r.is_none()))}is_none_or(r){return this.body.then((e=>e.is_none_or(r)))}map(r){return new e(this.body.then((e=>e.map(r))))}map_async(n){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?p(yield n(e.unwrap())):l()})))))}flat_map(r){return new e(this.body.then((e=>e.is_some()?r(e.unwrap()):n())))}and(n){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?n:l()})))))}or(n){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?e:n})))))}or_else(n){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?e:n()})))))}ok_or(r){return d.async(this.body.then((e=>e.ok_or(r))))}ok_or_else(r){return d.async(this.body.then((e=>e.ok_or_else(r))))}filter(r){return new e(this.body.then((e=>e.filter(r))))}zip(n){return new e((()=>r(this,void 0,void 0,(function*(){return(yield this.body).zip(yield n)})))())}}const n=()=>new e(Promise.resolve(l())),t=r=>new e(Promise.resolve(p(r)));class o{constructor(r){this.body=r}then(r,e){return this.body.then(r,e)}unwrap(){return this.body.then((r=>r.unwrap()))}unwrap_or(r){return this.body.then((e=>e.unwrap_or(r)))}unwrap_or_else(r){return this.body.then((e=>e.unwrap_or(r())))}is_ok(){return this.body.then((r=>r.is_ok()))}is_ok_and(r){return this.body.then((e=>e.is_ok_and(r)))}is_err(){return this.body.then((r=>r.is_err()))}is_err_or(r){return this.body.then((e=>e.is_err_and(r)))}map(r){return new o(this.body.then((e=>e.map(r))))}map_async(e){return new o(this.body.then((n=>r(this,void 0,void 0,(function*(){return n.is_ok()?h(yield e(n.unwrap())):n})))))}flat_map(r){return new o(this.body.then((e=>e.is_ok()?r(e.unwrap()):e)))}and(e){return new o(this.body.then((n=>r(this,void 0,void 0,(function*(){return n.is_ok()?e:n})))))}or(e){return new o(this.body.then((n=>r(this,void 0,void 0,(function*(){return n.is_ok()?n:e})))))}or_else(e){return new o(this.body.then((n=>r(this,void 0,void 0,(function*(){return n.is_ok()?n:e()})))))}ok(){return w.async(this.body.then((r=>r.ok())))}err(){return w.async(this.body.then((r=>r.err())))}invert(){return new o(this.body.then((r=>r.invert())))}}const s=r=>new o(Promise.resolve(_(r))),i=r=>new o(Promise.resolve(h(r)));class u{constructor(r){this.val=r}unwrap(){return this.val}unwrap_or(r){return this.val}unwrap_or_else(r){return this.val}unwrap_err(){throw new Error(`tried to unwrap_err Ok: ${this.val}`)}is_ok(){return!0}is_ok_and(r){return r(this.val)}is_err(){return!1}is_err_and(r){return!1}map(r){return new u(r(this.val))}map_err(r){return this}flat_map(r){return r(this.val)}and(r){return r}or(r){return this}or_else(r){return this}ok(){return p(this.val)}err(){return l()}invert(){return _(this.val)}async(){return i(this.val)}throw(){throw this.val}}const h=r=>new u(r);class a{constructor(r){this.e=r}unwrap(){throw new Error(`tried to unwrap Err value: ${this.e}`)}unwrap_or(r){return r}unwrap_or_else(r){return r()}unwrap_err(){return this.e}is_ok(){return!1}is_ok_and(r){return!1}is_err(){return!0}is_err_and(r){return r(this.e)}map(r){return this}map_err(r){return new a(r(this.e))}flat_map(r){return this}and(r){return this}or(r){return r}or_else(r){return r(this.e)}ok(){return l()}err(){return p(this.e)}invert(){return h(this.e)}async(){return s(this.e)}throw(){throw this.e}}const _=r=>new a(r),d={try:r=>{try{const e=r();return h(e)}catch(r){return _(r)}},try_async:e=>r(void 0,void 0,void 0,(function*(){try{const r=yield e();return h(r)}catch(r){return _(r)}})),try_promise:e=>r(void 0,void 0,void 0,(function*(){try{const r=yield e;return h(r)}catch(r){return _(r)}})),async:r=>new o(r),all:r=>{const e=[];for(const n of r){if(!n.is_ok())return n;e.push(n.unwrap())}return h(e)},any:r=>{const e=[];for(const n of r){if(n.is_ok())return n;e.push(n.unwrap_err())}return _(e)}};class m{unwrap(){throw new Error("tried to unwrap None value")}unwrap_or(r){return r}unwrap_or_else(r){return r()}is_some(){return!1}is_some_and(r){return!1}is_none(){return!0}is_none_or(r){return!0}map(r){return this.cast()}flat_map(r){return this.cast()}and(r){return this.cast()}or(r){return r}or_else(r){return r()}ok_or(r){return _(r)}ok_or_else(r){return _(r())}filter(r){return this}zip(r){return this}raw(){}async(){return n()}cast(){return this.cast()}}const l=()=>new m;class c{constructor(r){this.val=r}unwrap(){return this.val}unwrap_or(r){return this.val}unwrap_or_else(r){return this.val}is_some(){return!0}is_some_and(r){return r(this.val)}is_none(){return!1}is_none_or(r){return r(this.val)}map(r){return new c(r(this.val))}flat_map(r){return r(this.val)}and(r){return r}or(r){return this}or_else(r){return this}ok_or(r){return h(this.val)}ok_or_else(r){return h(this.val)}filter(r){return r(this.val)?this:l()}zip(r){return r.is_some()?new c([this.val,r.val]):l()}async(){return t(this.val)}raw(){return this.val}}const p=r=>new c(r),w={from:r=>null==r?l():p(r),all:r=>{const e=[];for(const n of r){if(!n.is_some())return l();e.push(n.unwrap())}return p(e)},any:r=>{for(const e of r)if(e.is_some())return e;return l()},async:r=>new e(r),is:r=>r instanceof c||r instanceof m};class v{constructor(r){this.f=r;const e=()=>{this.canceled||(this.f(),this.anim_id=requestAnimationFrame(e))};this.anim_id=requestAnimationFrame(e),this.canceled=!1}cleanup(){cancelAnimationFrame(this.anim_id),this.canceled=!0}}class y{constructor(r,e,n){this.mousedown=l(),this.mouseup=l(),this.mousemove=l(),this.on_mousedown_f=r,this.on_mouseup_f=e,this.on_mousemove_f=n,this.mousedown_handler_capture=r=>{r.currentTarget.setPointerCapture(r.pointerId),this.mousedown=p(r)},this.mousedown_handler=r=>{this.mousedown=p(r)},this.mouseup_handler=r=>{this.mouseup=p(r)},this.mousemove_handler=r=>{this.mousemove=p(r)},this.frame=new v((()=>{this.on_mousedown_f.zip(this.mousedown).map((([r,e])=>r(e))),this.on_mouseup_f.zip(this.mouseup).map((([r,e])=>r(e))),this.on_mousemove_f.zip(this.mousemove).map((([r,e])=>r(e))),this.mousedown=l(),this.mouseup=l(),this.mousemove=l()})),this.elements=new Set}handlers(r=!1){return{onPointerDown:r?this.mousedown_handler_capture:this.mousedown_handler,onPointerUp:this.mouseup_handler,onPointerMove:this.mousemove_handler}}add_event_listener(r,e=!1){const{onPointerDown:n,onPointerUp:t,onPointerMove:o}=this.handlers(e);r.addEventListener("pointerdown",n),r.addEventListener("pointerup",t),r.addEventListener("pointermove",o),this.elements.add({elem:r,capture:e})}remove_event_listener(r,e=!1){const{onPointerDown:n,onPointerUp:t,onPointerMove:o}=this.handlers(e);r.removeEventListener("pointerdown",n),r.removeEventListener("pointerup",t),r.removeEventListener("pointermove",o),this.elements.delete({elem:r,capture:e})}cleanup(){this.frame.cleanup();for(const{elem:r,capture:e}of this.elements)this.remove_event_listener(r,e)}}y.Builder=class{constructor(){this.on_mousedown_f=l(),this.on_mouseup_f=l(),this.on_mousemove_f=l()}on_mousedown(r){return this.on_mousedown_f=p(r),this}on_mouseup(r){return this.on_mouseup_f=p(r),this}on_mousemove(r){return this.on_mousemove_f=p(r),this}build(){return new y(this.on_mousedown_f,this.on_mouseup_f,this.on_mousemove_f)}};var f=Object.freeze({__proto__:null,Err:_,ErrAsync:s,Frame:v,None:l,NoneAsync:n,Ok:h,OkAsync:i,Option:w,PointerHandler:y,Result:d,Some:p,SomeAsync:t});export{_ as Err,s as ErrAsync,v as Frame,f as Iriko,l as None,n as NoneAsync,h as Ok,i as OkAsync,w as Option,y as PointerHandler,d as Result,p as Some,t as SomeAsync};
