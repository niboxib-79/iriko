function r(r,e,t,n){return new(t||(t=Promise))((function(o,s){function i(r){try{h(n.next(r))}catch(r){s(r)}}function u(r){try{h(n.throw(r))}catch(r){s(r)}}function h(r){var e;r.done?o(r.value):(e=r.value,e instanceof t?e:new t((function(r){r(e)}))).then(i,u)}h((n=n.apply(r,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class e{constructor(r){this.body=r}then(r,e){return this.body.then(r,e)}unwrap(){return this.body.then((r=>r.unwrap()))}unwrap_or(r){return this.body.then((e=>e.unwrap_or(r)))}unwrap_or_else(r){return this.body.then((e=>e.unwrap_or(r())))}is_some(){return this.body.then((r=>r.is_some()))}is_some_and(r){return this.body.then((e=>e.is_some_and(r)))}is_none(){return this.body.then((r=>r.is_none()))}is_none_or(r){return this.body.then((e=>e.is_none_or(r)))}map(r){return new e(this.body.then((e=>e.map(r))))}map_async(t){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?m(yield t(e.unwrap())):_()})))))}flat_map(r){return new e(this.body.then((e=>e.is_some()?r(e.unwrap()):t())))}and(t){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?t:_()})))))}or(t){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?e:t})))))}or_else(t){return new e(this.body.then((e=>r(this,void 0,void 0,(function*(){return e.is_some()?e:t()})))))}ok_or(r){return h.async(this.body.then((e=>e.ok_or(r))))}ok_or_else(r){return h.async(this.body.then((e=>e.ok_or_else(r))))}filter(r){return new e(this.body.then((e=>e.filter(r))))}zip(t){return new e((()=>r(this,void 0,void 0,(function*(){return(yield this.body).zip(yield t)})))())}}const t=()=>new e(Promise.resolve(_()));class n{constructor(r){this.body=r}then(r,e){return this.body.then(r,e)}unwrap(){return this.body.then((r=>r.unwrap()))}unwrap_or(r){return this.body.then((e=>e.unwrap_or(r)))}unwrap_or_else(r){return this.body.then((e=>e.unwrap_or(r())))}is_ok(){return this.body.then((r=>r.is_ok()))}is_ok_and(r){return this.body.then((e=>e.is_ok_and(r)))}is_err(){return this.body.then((r=>r.is_err()))}is_err_or(r){return this.body.then((e=>e.is_err_and(r)))}map(r){return new n(this.body.then((e=>e.map(r))))}map_async(e){return new n(this.body.then((t=>r(this,void 0,void 0,(function*(){return t.is_ok()?s(yield e(t.unwrap())):t})))))}flat_map(r){return new n(this.body.then((e=>e.is_ok()?r(e.unwrap()):e)))}and(e){return new n(this.body.then((t=>r(this,void 0,void 0,(function*(){return t.is_ok()?e:t})))))}or(e){return new n(this.body.then((t=>r(this,void 0,void 0,(function*(){return t.is_ok()?t:e})))))}or_else(e){return new n(this.body.then((t=>r(this,void 0,void 0,(function*(){return t.is_ok()?t:e()})))))}ok(){return l.async(this.body.then((r=>r.ok())))}err(){return l.async(this.body.then((r=>r.err())))}invert(){return new n(this.body.then((r=>r.invert())))}}class o{constructor(r){this.val=r}unwrap(){return this.val}unwrap_or(r){return this.val}unwrap_or_else(r){return this.val}unwrap_err(){throw new Error(`tried to unwrap_err Ok: ${this.val}`)}is_ok(){return!0}is_ok_and(r){return r(this.val)}is_err(){return!1}is_err_and(r){return!1}map(r){return new o(r(this.val))}map_err(r){return this}flat_map(r){return r(this.val)}and(r){return r}or(r){return this}or_else(r){return this}ok(){return m(this.val)}err(){return _()}invert(){return u(this.val)}async(){return r=this.val,new n(Promise.resolve(s(r)));var r}throw(){throw this.val}}const s=r=>new o(r);class i{constructor(r){this.e=r}unwrap(){throw new Error(`tried to unwrap Err value: ${this.e}`)}unwrap_or(r){return r}unwrap_or_else(r){return r()}unwrap_err(){return this.e}is_ok(){return!1}is_ok_and(r){return!1}is_err(){return!0}is_err_and(r){return r(this.e)}map(r){return this}map_err(r){return new i(r(this.e))}flat_map(r){return this}and(r){return this}or(r){return r}or_else(r){return r(this.e)}ok(){return _()}err(){return m(this.e)}invert(){return s(this.e)}async(){return r=this.e,new n(Promise.resolve(u(r)));var r}throw(){throw this.e}}const u=r=>new i(r),h={try:r=>{try{const e=r();return s(e)}catch(r){return u(r)}},try_async:e=>r(void 0,void 0,void 0,(function*(){try{const r=yield e();return s(r)}catch(r){return u(r)}})),try_promise:e=>r(void 0,void 0,void 0,(function*(){try{const r=yield e;return s(r)}catch(r){return u(r)}})),async:r=>new n(r),all:r=>{const e=[];for(const t of r){if(!t.is_ok())return t;e.push(t.unwrap())}return s(e)},any:r=>{const e=[];for(const t of r){if(t.is_ok())return t;e.push(t.unwrap_err())}return u(e)}};class a{unwrap(){throw new Error("tried to unwrap None value")}unwrap_or(r){return r}unwrap_or_else(r){return r()}is_some(){return!1}is_some_and(r){return!1}is_none(){return!0}is_none_or(r){return!0}map(r){return this.cast()}flat_map(r){return this.cast()}and(r){return this.cast()}or(r){return r}or_else(r){return r()}ok_or(r){return u(r)}ok_or_else(r){return u(r())}filter(r){return this}zip(r){return this}raw(){}async(){return t()}cast(){return this.cast()}}const _=()=>new a;class d{constructor(r){this.val=r}unwrap(){return this.val}unwrap_or(r){return this.val}unwrap_or_else(r){return this.val}is_some(){return!0}is_some_and(r){return r(this.val)}is_none(){return!1}is_none_or(r){return r(this.val)}map(r){return new d(r(this.val))}flat_map(r){return r(this.val)}and(r){return r}or(r){return this}or_else(r){return this}ok_or(r){return s(this.val)}ok_or_else(r){return s(this.val)}filter(r){return r(this.val)?this:_()}zip(r){return r.is_some()?new d([this.val,r.val]):_()}async(){return r=this.val,new e(Promise.resolve(m(r)));var r}raw(){return this.val}}const m=r=>new d(r),l={from:r=>null==r?_():m(r),all:r=>{const e=[];for(const t of r){if(!t.is_some())return _();e.push(t.unwrap())}return m(e)},any:r=>{for(const e of r)if(e.is_some())return e;return _()},async:r=>new e(r),is:r=>r instanceof d||r instanceof a};class c{constructor(r){this.f=r;const e=()=>{this.canceled||(this.f(),this.anim_id=requestAnimationFrame(e))};this.anim_id=requestAnimationFrame(e),this.canceled=!1}cleanup(){cancelAnimationFrame(this.anim_id),this.canceled=!0}}class p{constructor(r,e,t){this.mousedown=_(),this.mouseup=_(),this.mousemove=_(),this.on_mousedown_f=r,this.on_mouseup_f=e,this.on_mousemove_f=t,this.mousedown_handler_capture=r=>{r.currentTarget.setPointerCapture(r.pointerId),this.mousedown=m(r)},this.mousedown_handler=r=>{this.mousedown=m(r)},this.mouseup_handler=r=>{this.mouseup=m(r)},this.mousemove_handler=r=>{this.mousemove=m(r)},this.frame=new c((()=>{this.on_mousedown_f.zip(this.mousedown).map((([r,e])=>r(e))),this.on_mouseup_f.zip(this.mouseup).map((([r,e])=>r(e))),this.on_mousemove_f.zip(this.mousemove).map((([r,e])=>r(e))),this.mousedown=_(),this.mouseup=_(),this.mousemove=_()})),this.elements=new Set}handlers(r=!1){return{onPointerDown:r?this.mousedown_handler_capture:this.mousedown_handler,onPointerUp:this.mouseup_handler,onPointerMove:this.mousemove_handler}}add_event_listener(r,e=!1){const{onPointerDown:t,onPointerUp:n,onPointerMove:o}=this.handlers(e);r.addEventListener("pointerdown",t),r.addEventListener("pointerup",n),r.addEventListener("pointermove",o),this.elements.add({elem:r,capture:e})}remove_event_listener(r,e=!1){const{onPointerDown:t,onPointerUp:n,onPointerMove:o}=this.handlers(e);r.removeEventListener("pointerdown",t),r.removeEventListener("pointerup",n),r.removeEventListener("pointermove",o),this.elements.delete({elem:r,capture:e})}cleanup(){this.frame.cleanup();for(const{elem:r,capture:e}of this.elements)this.remove_event_listener(r,e)}}p.Builder=class{constructor(){this.on_mousedown_f=_(),this.on_mouseup_f=_(),this.on_mousemove_f=_()}on_mousedown(r){return this.on_mousedown_f=m(r),this}on_mouseup(r){return this.on_mouseup_f=m(r),this}on_mousemove(r){return this.on_mousemove_f=m(r),this}build(){return new p(this.on_mousedown_f,this.on_mouseup_f,this.on_mousemove_f)}};var w=Object.freeze({__proto__:null,Err:u,Frame:c,None:_,Ok:s,Option:l,PointerHandler:p,Result:h,Some:m});export{u as Err,c as Frame,w as Iriko,_ as None,s as Ok,l as Option,p as PointerHandler,h as Result,m as Some};
