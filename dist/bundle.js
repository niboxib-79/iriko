function e(e,r,n,t){return new(n||(n=Promise))((function(o,s){function i(e){try{h(t.next(e))}catch(e){s(e)}}function u(e){try{h(t.throw(e))}catch(e){s(e)}}function h(e){var r;e.done?o(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,u)}h((t=t.apply(e,r||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class r{constructor(e){this.body=e}then(e,r){return this.body.then(e,r)}unwrap(){return this.body.then((e=>e.unwrap()))}unwrap_or(e){return this.body.then((r=>r.unwrap_or(e)))}unwrap_or_else(e){return this.body.then((r=>r.unwrap_or(e())))}is_some(){return this.body.then((e=>e.is_some()))}is_some_and(e){return this.body.then((r=>r.is_some_and(e)))}is_none(){return this.body.then((e=>e.is_none()))}is_none_or(e){return this.body.then((r=>r.is_none_or(e)))}map(e){return new r(this.body.then((r=>r.map(e))))}map_async(n){return new r(this.body.then((r=>e(this,void 0,void 0,(function*(){return r.is_some()?p(yield n(r.unwrap())):c()})))))}flat_map(e){return new r(this.body.then((r=>r.is_some()?e(r.unwrap()):n())))}and(n){return new r(this.body.then((r=>e(this,void 0,void 0,(function*(){return r.is_some()?n:c()})))))}or(n){return new r(this.body.then((r=>e(this,void 0,void 0,(function*(){return r.is_some()?r:n})))))}or_else(n){return new r(this.body.then((r=>e(this,void 0,void 0,(function*(){return r.is_some()?r:n()})))))}ok_or(e){return d.async(this.body.then((r=>r.ok_or(e))))}ok_or_else(e){return d.async(this.body.then((r=>r.ok_or_else(e))))}filter(e){return new r(this.body.then((r=>r.filter(e))))}zip(n){return new r((()=>e(this,void 0,void 0,(function*(){return(yield this.body).zip(yield n)})))())}}const n=()=>new r(Promise.resolve(c())),t=e=>new r(Promise.resolve(p(e)));class o{constructor(e){this.body=e}then(e,r){return this.body.then(e,r)}unwrap(){return this.body.then((e=>e.unwrap()))}unwrap_or(e){return this.body.then((r=>r.unwrap_or(e)))}unwrap_or_else(e){return this.body.then((r=>r.unwrap_or(e())))}is_ok(){return this.body.then((e=>e.is_ok()))}is_ok_and(e){return this.body.then((r=>r.is_ok_and(e)))}is_err(){return this.body.then((e=>e.is_err()))}is_err_or(e){return this.body.then((r=>r.is_err_and(e)))}map(e){return new o(this.body.then((r=>r.map(e))))}map_async(r){return new o(this.body.then((n=>e(this,void 0,void 0,(function*(){return n.is_ok()?h(yield r(n.unwrap())):n})))))}flat_map(e){return new o(this.body.then((r=>r.is_ok()?e(r.unwrap()):r)))}and(r){return new o(this.body.then((n=>e(this,void 0,void 0,(function*(){return n.is_ok()?r:n})))))}or(r){return new o(this.body.then((n=>e(this,void 0,void 0,(function*(){return n.is_ok()?n:r})))))}or_else(r){return new o(this.body.then((n=>e(this,void 0,void 0,(function*(){return n.is_ok()?n:r()})))))}ok(){return w.async(this.body.then((e=>e.ok())))}err(){return w.async(this.body.then((e=>e.err())))}invert(){return new o(this.body.then((e=>e.invert())))}}const s=e=>new o(Promise.resolve(_(e))),i=e=>new o(Promise.resolve(h(e)));class u{constructor(e){this.val=e}unwrap(){return this.val}unwrap_or(e){return this.val}unwrap_or_else(e){return this.val}unwrap_err(){throw new Error(`tried to unwrap_err Ok: ${this.val}`)}is_ok(){return!0}is_ok_and(e){return e(this.val)}is_err(){return!1}is_err_and(e){return!1}map(e){return new u(e(this.val))}map_err(e){return this}flat_map(e){return e(this.val)}and(e){return e}or(e){return this}or_else(e){return this}ok(){return p(this.val)}err(){return c()}invert(){return _(this.val)}async(){return i(this.val)}throw(){throw this.val}}const h=e=>new u(e);class a{constructor(e){this.e=e}unwrap(){throw new Error(`tried to unwrap Err value: ${this.e}`)}unwrap_or(e){return e}unwrap_or_else(e){return e()}unwrap_err(){return this.e}is_ok(){return!1}is_ok_and(e){return!1}is_err(){return!0}is_err_and(e){return e(this.e)}map(e){return this}map_err(e){return new a(e(this.e))}flat_map(e){return this}and(e){return this}or(e){return e}or_else(e){return e(this.e)}ok(){return c()}err(){return p(this.e)}invert(){return h(this.e)}async(){return s(this.e)}throw(){throw this.e}}const _=e=>new a(e),d=Object.freeze({try:e=>{try{const r=e();return h(r)}catch(e){return _(e)}},try_async:r=>e(void 0,void 0,void 0,(function*(){try{const e=yield r();return h(e)}catch(e){return _(e)}})),try_promise:r=>e(void 0,void 0,void 0,(function*(){try{const e=yield r;return h(e)}catch(e){return _(e)}})),async:e=>new o(e),all:e=>{const r=[];for(const n of e){if(!n.is_ok())return n;r.push(n.unwrap())}return h(r)},any:e=>{const r=[];for(const n of e){if(n.is_ok())return n;r.push(n.unwrap_err())}return _(r)}});class m{unwrap(){throw new Error("tried to unwrap None value")}unwrap_or(e){return e}unwrap_or_else(e){return e()}is_some(){return!1}is_some_and(e){return!1}is_none(){return!0}is_none_or(e){return!0}map(e){return this.cast()}flat_map(e){return this.cast()}and(e){return this.cast()}or(e){return e}or_else(e){return e()}ok_or(e){return _(e)}ok_or_else(e){return _(e())}filter(e){return this}zip(e){return this}raw(){}async(){return n()}cast(){return this.cast()}}const c=()=>new m;class l{constructor(e){this.val=e}unwrap(){return this.val}unwrap_or(e){return this.val}unwrap_or_else(e){return this.val}is_some(){return!0}is_some_and(e){return e(this.val)}is_none(){return!1}is_none_or(e){return e(this.val)}map(e){return new l(e(this.val))}flat_map(e){return e(this.val)}and(e){return e}or(e){return this}or_else(e){return this}ok_or(e){return h(this.val)}ok_or_else(e){return h(this.val)}filter(e){return e(this.val)?this:c()}zip(e){return e.is_some()?new l([this.val,e.val]):c()}async(){return t(this.val)}raw(){return this.val}}const p=e=>new l(e),w=Object.freeze({from:e=>null==e?c():p(e),all:e=>{const r=[];for(const n of e){if(!n.is_some())return c();r.push(n.unwrap())}return p(r)},any:e=>{for(const r of e)if(r.is_some())return r;return c()},async:e=>new r(e),is:e=>e instanceof l||e instanceof m});class v{constructor(e){this.f=e;const r=()=>{this.canceled||(this.f(),this.anim_id=requestAnimationFrame(r))};this.anim_id=requestAnimationFrame(r),this.canceled=!1}cleanup(){cancelAnimationFrame(this.anim_id),this.canceled=!0}}class y{constructor(e,r,n){this.mousedown=c(),this.mouseup=c(),this.mousemove=c(),this.on_mousedown_f=e,this.on_mouseup_f=r,this.on_mousemove_f=n,this.mousedown_handler_capture=e=>{e.currentTarget.setPointerCapture(e.pointerId),this.mousedown=p(e)},this.mousedown_handler=e=>{this.mousedown=p(e)},this.mouseup_handler=e=>{this.mouseup=p(e)},this.mousemove_handler=e=>{this.mousemove=p(e)},this.frame=new v((()=>{this.on_mousedown_f.zip(this.mousedown).map((([e,r])=>e(r))),this.on_mouseup_f.zip(this.mouseup).map((([e,r])=>e(r))),this.on_mousemove_f.zip(this.mousemove).map((([e,r])=>e(r))),this.mousedown=c(),this.mouseup=c(),this.mousemove=c()})),this.elements=new Set}handlers(e=!1){return{onPointerDown:e?this.mousedown_handler_capture:this.mousedown_handler,onPointerUp:this.mouseup_handler,onPointerMove:this.mousemove_handler}}add_event_listener(e,r=!1){const{onPointerDown:n,onPointerUp:t,onPointerMove:o}=this.handlers(r);e.addEventListener("pointerdown",n),e.addEventListener("pointerup",t),e.addEventListener("pointermove",o),this.elements.add({elem:e,capture:r})}remove_event_listener(e,r=!1){const{onPointerDown:n,onPointerUp:t,onPointerMove:o}=this.handlers(r);e.removeEventListener("pointerdown",n),e.removeEventListener("pointerup",t),e.removeEventListener("pointermove",o),this.elements.delete({elem:e,capture:r})}cleanup(){this.frame.cleanup();for(const{elem:e,capture:r}of this.elements)this.remove_event_listener(e,r)}}y.Builder=class{constructor(){this.on_mousedown_f=c(),this.on_mouseup_f=c(),this.on_mousemove_f=c()}on_mousedown(e){return this.on_mousedown_f=p(e),this}on_mouseup(e){return this.on_mouseup_f=p(e),this}on_mousemove(e){return this.on_mousemove_f=p(e),this}build(){return new y(this.on_mousedown_f,this.on_mouseup_f,this.on_mousemove_f)}};var f=Object.freeze({__proto__:null,Err:_,ErrAsync:s,Frame:v,None:c,NoneAsync:n,Ok:h,OkAsync:i,Option:w,PointerHandler:y,Result:d,Some:p,SomeAsync:t});export{_ as Err,s as ErrAsync,v as Frame,f as Iriko,c as None,n as NoneAsync,h as Ok,i as OkAsync,w as Option,y as PointerHandler,d as Result,p as Some,t as SomeAsync};
